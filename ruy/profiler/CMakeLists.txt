# Copyright 2021 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      https://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

# Do not edit! This file was auto-generated by this program:
#   cmake/bazel_to_cmake.py . ruy/profiler
# To regenerate CMakeLists.txt for all subdirectories, just run:
#   cmake/bazel_to_cmake.sh

if(${RUY_PROFILER})
  set(RUY_SELECT_ruy_profiler_0 "RUY_PROFILER")
else()
  set(RUY_SELECT_ruy_profiler_0 "")
endif()

if(CMAKE_SYSTEM_NAME STREQUAL Windows)
  # nothing goes into RUY_SELECT_ruy_profiler_1
else()
  set(RUY_SELECT_ruy_profiler_1 "-pthread")
endif()

cc_library(
  NAME
    ruy_profiler_instrumentation
  SRCS
    instrumentation.cc
  HDRS
    instrumentation.h
  DEFINES
    ${RUY_SELECT_ruy_profiler_0}
  LINKOPTS
    ${RUY_SELECT_ruy_profiler_1}
  PUBLIC
)

cc_library(
  NAME
    ruy_profiler_profiler
  SRCS
    profiler.cc
    treeview.cc
  HDRS
    profiler.h
    treeview.h
  LINKOPTS
    ${RUY_SELECT_ruy_profiler_1}
  PUBLIC
  DEPS
    ruy_profiler_instrumentation
)

cc_library(
  NAME
    ruy_profiler_test_instrumented_library
  TESTONLY
  SRCS
    test_instrumented_library.cc
  HDRS
    test_instrumented_library.h
  DEPS
    ruy_profiler_instrumentation
)

cc_test(
  NAME
    ruy_profiler_test
  SRCS
    test.cc
  LINKOPTS
    ${RUY_SELECT_ruy_profiler_1}
  DEPS
    ruy_profiler_profiler
    ruy_profiler_test_instrumented_library
    ruy_gtest_wrapper
)



add_all_subdirs()

